require 'spec_helper'

module Core
  RSpec.describe Repository::Customers::Cream do
    describe '#find' do
      context 'when customer exists' do
        let(:client){ double("client", find_customer: response) }
        let(:user){ User.new }
        let(:response) do
{"d"=>{"results"=>[{"__metadata"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')", "type"=>"Microsoft.Crm.Sdk.Data.Services.Contact"}, "SpousesName"=>nil, "EMailAddress3"=>nil, "mas_FinancialInterest9"=>false, "Address2_ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "mas_HasWebAccount"=>false, "PreferredServiceId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest7"=>false, "mas_Address1_Country"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "VersionNumber"=>nil, "AnnualIncome"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address2_Line2"=>nil, "Fax"=>nil, "Telephone3"=>nil, "PreferredAppointmentDayCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address2_StateOrProvince"=>nil, "CreatedBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>"Integration, CRM"}, "Address2_Line1"=>nil, "LastUsedInCampaign"=>nil, "YomiLastName"=>nil, "Pager"=>nil, "EmployeeId"=>nil, "TerritoryCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "ParentCustomerId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "ManagerName"=>nil, "BirthDate"=>"/Date(470448000000)/", "mas_FinancialInterest5"=>false, "NumberOfChildren"=>nil, "Address1_AddressTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "OwningTeam"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Address2_PostalCode"=>nil, "UTCConversionTimeZoneCode"=>nil, "OwningUser"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>nil}, "AssistantPhone"=>nil, "MasterId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "CreatedOnBehalfBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest3"=>false, "SubscriptionId"=>nil, "Address1_Latitude"=>nil, "mas_ContactEmail"=>"some_email15@gmail.com", "MobilePhone"=>nil, "CustomerTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "ManagerPhone"=>nil, "Address1_FreightTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address1_Longitude"=>nil, "Address2_Telephone2"=>nil, "StatusCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "YomiFullName"=>"Mustermann, Max", "Aging90_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "AccountId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest2"=>false, "mas_FinancialInterest4"=>false, "FamilyStatusCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_DraftStatus"=>false, "FirstName"=>"Max", "Address2_Latitude"=>nil, "Department"=>nil, "OriginatingLeadId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Aging60"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "mas_AllowtobecontactedforSurvey"=>false, "StateCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>0}, "Address2_FreightTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "mas_Title"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address1_Name"=>nil, "mas_PreferredLanguage"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>809610000}, "YomiMiddleName"=>nil, "ModifiedOnBehalfBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_IsCustomerAutosave"=>false, "Description"=>nil, "mas_ResponsibleforChildren16andUnder"=>nil, "mas_StrategicPartner"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "EducationCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_Telephone3"=>nil, "Address2_Telephone1"=>nil, "ImportSequenceNumber"=>nil, "GenderCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "OwnerId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>"Integration, CRM"}, "Address2_AddressTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_UTCOffset"=>nil, "CreditLimit_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Aging60_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_County"=>nil, "OwningBusinessUnit"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"391481b5-d0b3-e111-a303-0050569c2d72", "LogicalName"=>"businessunit", "Name"=>nil}, "JobTitle"=>nil, "mas_websitetoken"=>nil, "Address1_Telephone2"=>nil, "TimeZoneRuleVersionNumber"=>0, "Address1_Fax"=>nil, "Address2_PostOfficeBox"=>nil, "Address1_Line2"=>nil, "WebSiteUrl"=>nil, "DoNotPostalMail"=>false, "Address2_UTCOffset"=>nil, "mas_FinancialInterest10"=>false, "ExchangeRate"=>nil, "CreatedOn"=>"/Date(1377603338000)/", "EMailAddress2"=>nil, "Address2_Line3"=>nil, "Address2_AddressId"=>"a54d0664-0690-4802-9d68-76f544cdc506", "OverriddenCreatedOn"=>nil, "AnnualIncome_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_Telephone1"=>nil, "mas_CustomerId"=>100003301, "mas_RefusedtoAnswerBirthDate"=>false, "ChildrensNames"=>nil, "PreferredContactMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Aging90"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "DoNotBulkPostalMail"=>false, "EMailAddress1"=>"some_email15@gmail.com", "DoNotBulkEMail"=>true, "CustomerSizeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_StateOrProvince"=>nil, "FullName"=>"Mustermann, Max", "PreferredAppointmentTimeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "TransactionCurrencyId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_AgeRange"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "PaymentTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_EthnicBackground"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Aging30"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "LeadSourceCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Merged"=>false, "mas_FinancialInterest1"=>false, "Address2_County"=>nil, "Address1_ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "FtpSiteUrl"=>nil, "PreferredSystemUserId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Address1_AddressId"=>"135c2c42-b342-4383-89a2-4adf2fa857c8", "NickName"=>nil, "Address1_PostOfficeBox"=>nil, "PreferredEquipmentId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "AssistantName"=>nil, "Address2_Country"=>nil, "ModifiedOn"=>"/Date(1377603353000)/", "ExternalUserIdentifier"=>nil, "Address2_Name"=>nil, "CreditOnHold"=>false, "ParticipatesInWorkflow"=>false, "AccountRoleCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_IsInPilot"=>nil, "Address2_Telephone3"=>nil, "DoNotPhone"=>false, "ContactId"=>"7efbe4c5-0c0f-e311-8978-005056822583", "DoNotFax"=>false, "Aging30_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_UPSZone"=>nil, "Suffix"=>nil, "Address1_PrimaryContactName"=>nil, "mas_FinancialInterest8"=>false, "mas_FinancialInterest6"=>false, "Salutation"=>nil, "ModifiedBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"c9d77bbb-d0b3-e111-a303-0050569c2d72", "LogicalName"=>"systemuser", "Name"=>"User, CRMDevAdmin"}, "GovernmentId"=>nil, "Address2_PrimaryContactName"=>nil, "mas_WillingtoParticipateinCaseStudies"=>false, "DoNotSendMM"=>false, "Address2_Longitude"=>nil, "Address1_Country"=>nil, "LastName"=>"Mustermann", "Address2_City"=>nil, "mas_RefusedtoAnswerPostcode"=>false, "DoNotEMail"=>false, "Address1_City"=>nil, "YomiFirstName"=>nil, "Telephone1"=>nil, "Address1_Line1"=>nil, "ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "CreditLimit"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Anniversary"=>nil, "Telephone2"=>nil, "ParentContactId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "HasChildrenCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address2_Fax"=>nil, "IsBackofficeCustomer"=>false, "Address1_Line3"=>nil, "Address2_UPSZone"=>nil, "DefaultPriceLevelId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "MiddleName"=>nil, "Address1_PostalCode"=>nil, "contactquotes_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contactquotes_association"}}, "listcontact_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/listcontact_association"}}, "contactinvoices_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contactinvoices_association"}}, "contactorders_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contactorders_association"}}, "servicecontractcontacts_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/servicecontractcontacts_association"}}, "contactleads_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contactleads_association"}}, "contact_principalobjectattributeaccess"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_principalobjectattributeaccess"}}, "contact_connections1"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_connections1"}}, "Contact_ProcessSessions"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_ProcessSessions"}}, "Contact_ActivityPointers"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_ActivityPointers"}}, "contact_PostFollows"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_PostFollows"}}, "invoice_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/invoice_customer_contacts"}}, "quote_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/quote_customer_contacts"}}, "contact_customer_relationship_partner"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_customer_relationship_partner"}}, "CreatedContact_BulkOperationLogs"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/CreatedContact_BulkOperationLogs"}}, "Contact_Phonecalls"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Phonecalls"}}, "Contact_Tasks"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Tasks"}}, "lk_contact_createdonbehalfby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/lk_contact_createdonbehalfby"}}, "lead_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/lead_customer_contacts"}}, "Contact_Annotation"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Annotation"}}, "Referencingcontact_master_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Referencingcontact_master_contact"}}, "Referencedcontact_master_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Referencedcontact_master_contact"}}, "contact_originating_lead"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_originating_lead"}}, "Contact_ServiceAppointments"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_ServiceAppointments"}}, "lk_contact_modifiedonbehalfby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/lk_contact_modifiedonbehalfby"}}, "userentityinstancedata_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/userentityinstancedata_contact"}}, "account_primary_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/account_primary_contact"}}, "lk_contactbase_createdby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/lk_contactbase_createdby"}}, "contract_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contract_customer_contacts"}}, "contact_customer_relationship_customer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_customer_relationship_customer"}}, "contract_billingcustomer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contract_billingcustomer_contacts"}}, "Contact_CustomerAddress"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_CustomerAddress"}}, "business_unit_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/business_unit_contacts"}}, "incident_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/incident_customer_contacts"}}, "team_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/team_contacts"}}, "contact_customer_accounts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_customer_accounts"}}, "Contact_DuplicateMatchingRecord"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_DuplicateMatchingRecord"}}, "order_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/order_customer_contacts"}}, "system_user_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/system_user_contacts"}}, "Contact_Faxes"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Faxes"}}, "service_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/service_contacts"}}, "contact_as_responsible_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_as_responsible_contact"}}, "Contact_Appointments"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Appointments"}}, "contact_owning_user"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_owning_user"}}, "equipment_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/equipment_contacts"}}, "Contact_AsyncOperations"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_AsyncOperations"}}, "SourceContact_BulkOperationLogs"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/SourceContact_BulkOperationLogs"}}, "transactioncurrency_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/transactioncurrency_contact"}}, "contact_customer_opportunity_roles"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_customer_opportunity_roles"}}, "Contact_RecurringAppointmentMasters"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_RecurringAppointmentMasters"}}, "Contact_BulkDeleteFailures"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_BulkDeleteFailures"}}, "Referencingcontact_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Referencingcontact_customer_contacts"}}, "Referencedcontact_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Referencedcontact_customer_contacts"}}, "contact_connections2"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_connections2"}}, "Contact_DuplicateBaseRecord"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_DuplicateBaseRecord"}}, "contractlineitem_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contractlineitem_customer_contacts"}}, "lk_contactbase_modifiedby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/lk_contactbase_modifiedby"}}, "Contact_Emails"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Emails"}}, "opportunity_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/opportunity_customer_contacts"}}, "price_level_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/price_level_contacts"}}, "contact_activity_parties"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_activity_parties"}}, "Contact_Letters"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/Contact_Letters"}}, "contact_mas_facetofacemeetings"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_mas_facetofacemeetings"}}, "mas_contact_mas_printedmaterialfulfilment_Customer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/mas_contact_mas_printedmaterialfulfilment_Customer"}}, "contact_mas_websiteactivities"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_mas_websiteactivities"}}, "mas_contact_mas_solutionconfig_AnonymousCustomer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/mas_contact_mas_solutionconfig_AnonymousCustomer"}}, "ccmd_contact_ccmd_nmpemailsending"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_nmpemailsending"}}, "ccmd_contact_ccmd_nmpmessagetemplate"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_nmpmessagetemplate"}}, "ccmd_contact_ccmd_ccmdindividual"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_ccmdindividual"}}, "contact_mas_webchats"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'7efbe4c5-0c0f-e311-8978-005056822583')/contact_mas_webchats"}}}, {"__metadata"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')", "type"=>"Microsoft.Crm.Sdk.Data.Services.Contact"}, "SpousesName"=>nil, "EMailAddress3"=>nil, "mas_FinancialInterest9"=>false, "Address2_ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "mas_HasWebAccount"=>false, "PreferredServiceId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest7"=>false, "mas_Address1_Country"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "VersionNumber"=>nil, "AnnualIncome"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address2_Line2"=>nil, "Fax"=>nil, "Telephone3"=>nil, "PreferredAppointmentDayCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address2_StateOrProvince"=>nil, "CreatedBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>"Integration, CRM"}, "Address2_Line1"=>nil, "LastUsedInCampaign"=>nil, "YomiLastName"=>nil, "Pager"=>nil, "EmployeeId"=>nil, "TerritoryCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "ParentCustomerId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "ManagerName"=>nil, "BirthDate"=>nil, "mas_FinancialInterest5"=>false, "NumberOfChildren"=>nil, "Address1_AddressTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "OwningTeam"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Address2_PostalCode"=>nil, "UTCConversionTimeZoneCode"=>nil, "OwningUser"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>nil}, "AssistantPhone"=>nil, "MasterId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "CreatedOnBehalfBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest3"=>false, "SubscriptionId"=>nil, "Address1_Latitude"=>nil, "mas_ContactEmail"=>"some_email15@gmail.com", "MobilePhone"=>nil, "CustomerTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "ManagerPhone"=>nil, "Address1_FreightTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address1_Longitude"=>nil, "Address2_Telephone2"=>nil, "StatusCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>809610000}, "YomiFullName"=>nil, "Aging90_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "AccountId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_FinancialInterest2"=>false, "mas_FinancialInterest4"=>false, "FamilyStatusCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_DraftStatus"=>false, "FirstName"=>nil, "Address2_Latitude"=>nil, "Department"=>nil, "OriginatingLeadId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Aging60"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "mas_AllowtobecontactedforSurvey"=>false, "StateCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>0}, "Address2_FreightTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "mas_Title"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Address1_Name"=>nil, "mas_PreferredLanguage"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>809610000}, "YomiMiddleName"=>nil, "ModifiedOnBehalfBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_IsCustomerAutosave"=>false, "Description"=>nil, "mas_ResponsibleforChildren16andUnder"=>nil, "mas_StrategicPartner"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "EducationCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_Telephone3"=>nil, "Address2_Telephone1"=>nil, "ImportSequenceNumber"=>nil, "GenderCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "OwnerId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"504c5799-44b9-e111-823b-00505682257b", "LogicalName"=>"systemuser", "Name"=>"Integration, CRM"}, "Address2_AddressTypeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_UTCOffset"=>nil, "CreditLimit_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Aging60_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_County"=>nil, "OwningBusinessUnit"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"391481b5-d0b3-e111-a303-0050569c2d72", "LogicalName"=>"businessunit", "Name"=>nil}, "JobTitle"=>nil, "mas_websitetoken"=>nil, "Address1_Telephone2"=>nil, "TimeZoneRuleVersionNumber"=>nil, "Address1_Fax"=>nil, "Address2_PostOfficeBox"=>nil, "Address1_Line2"=>nil, "WebSiteUrl"=>nil, "DoNotPostalMail"=>false, "Address2_UTCOffset"=>nil, "mas_FinancialInterest10"=>false, "ExchangeRate"=>nil, "CreatedOn"=>"/Date(1377603339000)/", "EMailAddress2"=>nil, "Address2_Line3"=>nil, "Address2_AddressId"=>"b377f78e-7de9-4bef-b667-04bec098a1c0", "OverriddenCreatedOn"=>nil, "AnnualIncome_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_Telephone1"=>nil, "mas_CustomerId"=>100003302, "mas_RefusedtoAnswerBirthDate"=>false, "ChildrensNames"=>nil, "PreferredContactMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Aging90"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "DoNotBulkPostalMail"=>false, "EMailAddress1"=>"some_email15@gmail.com", "DoNotBulkEMail"=>false, "CustomerSizeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address1_StateOrProvince"=>nil, "FullName"=>nil, "PreferredAppointmentTimeCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "TransactionCurrencyId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "mas_AgeRange"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "PaymentTermsCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_EthnicBackground"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "Aging30"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "LeadSourceCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Merged"=>false, "mas_FinancialInterest1"=>false, "Address2_County"=>nil, "Address1_ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "FtpSiteUrl"=>nil, "PreferredSystemUserId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "Address1_AddressId"=>"7f2c5037-381c-4869-90a4-f1607c5e79fb", "NickName"=>nil, "Address1_PostOfficeBox"=>nil, "PreferredEquipmentId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "AssistantName"=>nil, "Address2_Country"=>nil, "ModifiedOn"=>"/Date(1377603358000)/", "ExternalUserIdentifier"=>nil, "Address2_Name"=>nil, "CreditOnHold"=>false, "ParticipatesInWorkflow"=>false, "AccountRoleCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>nil}, "mas_IsInPilot"=>nil, "Address2_Telephone3"=>nil, "DoNotPhone"=>false, "ContactId"=>"82fbe4c5-0c0f-e311-8978-005056822583", "DoNotFax"=>false, "Aging30_Base"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Address1_UPSZone"=>nil, "Suffix"=>nil, "Address1_PrimaryContactName"=>nil, "mas_FinancialInterest8"=>false, "mas_FinancialInterest6"=>false, "Salutation"=>nil, "ModifiedBy"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>"c9d77bbb-d0b3-e111-a303-0050569c2d72", "LogicalName"=>"systemuser", "Name"=>"User, CRMDevAdmin"}, "GovernmentId"=>nil, "Address2_PrimaryContactName"=>nil, "mas_WillingtoParticipateinCaseStudies"=>false, "DoNotSendMM"=>false, "Address2_Longitude"=>nil, "Address1_Country"=>nil, "LastName"=>nil, "Address2_City"=>nil, "mas_RefusedtoAnswerPostcode"=>false, "DoNotEMail"=>false, "Address1_City"=>nil, "YomiFirstName"=>nil, "Telephone1"=>nil, "Address1_Line1"=>nil, "ShippingMethodCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "CreditLimit"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.Money"}, "Value"=>nil}, "Anniversary"=>nil, "Telephone2"=>nil, "ParentContactId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "HasChildrenCode"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.OptionSetValue"}, "Value"=>1}, "Address2_Fax"=>nil, "IsBackofficeCustomer"=>false, "Address1_Line3"=>nil, "Address2_UPSZone"=>nil, "DefaultPriceLevelId"=>{"__metadata"=>{"type"=>"Microsoft.Crm.Sdk.Data.Services.EntityReference"}, "Id"=>nil, "LogicalName"=>nil, "Name"=>nil}, "MiddleName"=>nil, "Address1_PostalCode"=>nil, "contactquotes_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contactquotes_association"}}, "listcontact_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/listcontact_association"}}, "contactinvoices_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contactinvoices_association"}}, "contactorders_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contactorders_association"}}, "servicecontractcontacts_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/servicecontractcontacts_association"}}, "contactleads_association"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contactleads_association"}}, "contact_principalobjectattributeaccess"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_principalobjectattributeaccess"}}, "contact_connections1"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_connections1"}}, "Contact_ProcessSessions"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_ProcessSessions"}}, "Contact_ActivityPointers"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_ActivityPointers"}}, "contact_PostFollows"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_PostFollows"}}, "invoice_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/invoice_customer_contacts"}}, "quote_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/quote_customer_contacts"}}, "contact_customer_relationship_partner"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_customer_relationship_partner"}}, "CreatedContact_BulkOperationLogs"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/CreatedContact_BulkOperationLogs"}}, "Contact_Phonecalls"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Phonecalls"}}, "Contact_Tasks"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Tasks"}}, "lk_contact_createdonbehalfby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/lk_contact_createdonbehalfby"}}, "lead_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/lead_customer_contacts"}}, "Contact_Annotation"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Annotation"}}, "Referencingcontact_master_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Referencingcontact_master_contact"}}, "Referencedcontact_master_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Referencedcontact_master_contact"}}, "contact_originating_lead"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_originating_lead"}}, "Contact_ServiceAppointments"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_ServiceAppointments"}}, "lk_contact_modifiedonbehalfby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/lk_contact_modifiedonbehalfby"}}, "userentityinstancedata_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/userentityinstancedata_contact"}}, "account_primary_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/account_primary_contact"}}, "lk_contactbase_createdby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/lk_contactbase_createdby"}}, "contract_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contract_customer_contacts"}}, "contact_customer_relationship_customer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_customer_relationship_customer"}}, "contract_billingcustomer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contract_billingcustomer_contacts"}}, "Contact_CustomerAddress"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_CustomerAddress"}}, "business_unit_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/business_unit_contacts"}}, "incident_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/incident_customer_contacts"}}, "team_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/team_contacts"}}, "contact_customer_accounts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_customer_accounts"}}, "Contact_DuplicateMatchingRecord"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_DuplicateMatchingRecord"}}, "order_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/order_customer_contacts"}}, "system_user_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/system_user_contacts"}}, "Contact_Faxes"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Faxes"}}, "service_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/service_contacts"}}, "contact_as_responsible_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_as_responsible_contact"}}, "Contact_Appointments"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Appointments"}}, "contact_owning_user"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_owning_user"}}, "equipment_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/equipment_contacts"}}, "Contact_AsyncOperations"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_AsyncOperations"}}, "SourceContact_BulkOperationLogs"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/SourceContact_BulkOperationLogs"}}, "transactioncurrency_contact"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/transactioncurrency_contact"}}, "contact_customer_opportunity_roles"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_customer_opportunity_roles"}}, "Contact_RecurringAppointmentMasters"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_RecurringAppointmentMasters"}}, "Contact_BulkDeleteFailures"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_BulkDeleteFailures"}}, "Referencingcontact_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Referencingcontact_customer_contacts"}}, "Referencedcontact_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Referencedcontact_customer_contacts"}}, "contact_connections2"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_connections2"}}, "Contact_DuplicateBaseRecord"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_DuplicateBaseRecord"}}, "contractlineitem_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contractlineitem_customer_contacts"}}, "lk_contactbase_modifiedby"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/lk_contactbase_modifiedby"}}, "Contact_Emails"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Emails"}}, "opportunity_customer_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/opportunity_customer_contacts"}}, "price_level_contacts"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/price_level_contacts"}}, "contact_activity_parties"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_activity_parties"}}, "Contact_Letters"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/Contact_Letters"}}, "contact_mas_facetofacemeetings"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_mas_facetofacemeetings"}}, "mas_contact_mas_printedmaterialfulfilment_Customer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/mas_contact_mas_printedmaterialfulfilment_Customer"}}, "contact_mas_websiteactivities"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_mas_websiteactivities"}}, "mas_contact_mas_solutionconfig_AnonymousCustomer"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/mas_contact_mas_solutionconfig_AnonymousCustomer"}}, "ccmd_contact_ccmd_nmpemailsending"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_nmpemailsending"}}, "ccmd_contact_ccmd_nmpmessagetemplate"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_nmpmessagetemplate"}}, "ccmd_contact_ccmd_ccmdindividual"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/ccmd_contact_ccmd_ccmdindividual"}}, "contact_mas_webchats"=>{"__deferred"=>{"uri"=>"https://crmtest.test.moneyadviceservice.org.uk/xrmservices/2011/OrganizationData.svc/ContactSet(guid'82fbe4c5-0c0f-e311-8978-005056822583')/contact_mas_webchats"}}}]}}
        end

        it 'returns the customer' do
          expect(::Cream::Client).to receive(:instance).and_return(client)

          expect(client).to receive(:find_customer).with({customer_id: 123}).and_return(response)

          expect(subject.find(id: 123)).to be_a(Customer)
        end
      end

      context 'when customer does not exist' do
        let(:client){ double("client", find_customer: response) }
        let(:user){ User.new }
        let(:response) do
          {"d"=>{"results"=>[]}}
        end

        it 'returns nil' do
          expect(::Cream::Client).to receive(:instance).and_return(client)

          expect(client).to receive(:find_customer).with({customer_id: 123}).and_return(response)

          expect(subject.find(id: 123)).to be_nil
        end
      end
    end

    describe '#create' do
      let(:user){ User.new }
      let(:mas_customer_id){ '123' }
      let(:response) do
        {
          'd' => { 'mas_CustomerId' => mas_customer_id }
        }
      end

      it 'uses cream client to create' do
        client = double("client", create_customer: response)
        expect(::Cream::Client).to receive(:instance).and_return(client)

        expect(client).to receive(:create_customer).with(user).and_return(response)
        expect(subject.create(user)).to eql(mas_customer_id)
      end
    end

    describe '#update' do
      context 'when customer exists' do
        let(:client){ double("client", find_customer: response) }
        let(:user){ FactoryGirl.create(:user) }
        let(:response){ true }

        it 'updates the customer' do
          client = double("client", create_customer: response)
          expect(::Cream::Client).to receive(:instance).and_return(client)

          expect(client).to receive(:update_customer).with(user.customer_id, kind_of(Hash)).and_return(response)
          expect(subject.update(user.to_customer)).to eql(response)
        end
      end
    end

    describe '#valid_for_authentication?' do
      let(:id){ 1 }

      context 'when they exist in crm' do
        it 'returns true' do
          allow(subject).to receive(:find).with(id: id){ Object.new }
          expect(subject.valid_for_authentication?(id)).to be_truthy
        end
      end

      context 'when they no not exist in crm' do
        it 'returns false' do
          allow(subject).to receive(:find){ nil }
          expect(subject.valid_for_authentication?(id)).to be_falsey
        end
      end
    end
  end
end
